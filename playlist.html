<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>My Playlist</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
 
  <link rel="stylesheet" href="songInfo.css">  
  <script src="songInfo.js"></script>

  <style>
    :root{
      --accent-color: #00d084;
      --bg-color: var(--bg-color, #0f1116);
      --text-color: var(--text-color, #e9ecef);
      --card-bg: var(--card-bg, #171a21);
      --muted: var(--muted, #aeb7c2);
    }
    html, body{ background: var(--bg-color); color: var(--text-color); }
    a{ color: inherit; }

    h1, .display-title{ font-weight:700; line-height:1.15; }
    .lead{ color: var(--muted); }
    :root{ --fs-h1: clamp(1.6rem, 4.5vw, 2rem); --fs-h2: clamp(1.25rem, 3.8vw, 1.6rem); --fs-base: 1rem; }
    h1, .display-title{ font-size: var(--fs-h1); } h2{ font-size: var(--fs-h2); } body{ font-size: var(--fs-base); }
    @media (min-width:768px){ :root{ --fs-h1:2.25rem; --fs-h2:1.75rem; --fs-base:1.05rem; } }
    @media (min-width:1200px){ :root{ --fs-h1:2.6rem; --fs-h2:2rem; --fs-base:1.08rem; } }

    .vinyl{ width:220px;height:220px;border-radius:50%;margin-inline:auto;margin-top:1.2rem;position:relative;
      background: radial-gradient(circle at 50% 50%, #2a2c33 0 35%, #0e0f13 36% 100%);
      box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 0 0 6px rgba(255,255,255,.06);
      animation: spin 12s linear infinite;
    }
    .vinyl::before{ content:"";position:absolute;inset:0;border-radius:50%;
      background: repeating-radial-gradient(circle at 50% 50%, transparent 0 5px, rgba(255,255,255,.05) 6px 7px);
    }
    .vinyl .label{ position:absolute; inset:35% 35%; border-radius:50%; background: var(--accent-color); box-shadow:0 0 22px rgba(0,208,132,.75); }
    .vinyl .spindle{ position:absolute; inset:48% 48%; border-radius:50%; background:#0b0b0b; box-shadow:0 0 0 3px rgba(0,255,132,.25); }
    @keyframes spin{ to{ transform:rotate(360deg); } }
    @media (prefers-reduced-motion:reduce){ .vinyl{ animation:none; } }

    #playlistList .song-item{ background:var(--card-bg); border:1px solid rgba(255,255,255,.08); border-radius:12px;
      padding:12px 14px; display:flex; align-items:center; justify-content:space-between; gap:12px;
      transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    #playlistList .song-item:hover{ transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.35); border-color: rgba(0,208,132,.45); }
    .song-left{ display:flex; align-items:center; gap:12px; min-width:0; }
    .song-title{ cursor:pointer; color:var(--text-color); text-decoration:none; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:54vw; }
    .song-title:hover{ color: var(--accent-color); text-decoration: underline; }
    .song-play{ appearance:none; border:none; background:#1c1f24; color:#fff; width:36px;height:36px;border-radius:50%; display:inline-grid;place-items:center; cursor:pointer; }
    .song-play:hover{ background:#232731; }
    .remove-btn{ border:none; background:#dc3545; color:#fff; padding:8px 12px; border-radius:8px; font-weight:600; cursor:pointer; }
    .remove-btn:hover{ background:#bb2d3b; }
    .muted{ color:var(--muted); }
    .audio-wrap{ background:#0f1116; border:1px solid #1b1e25; border-radius:12px; padding:14px; }


    .mq-cards{ display:grid; gap:1rem; grid-template-columns:1fr; }
    .mq-card{ background:var(--card-bg); border:1px solid rgba(255,255,255,.08); border-radius:1rem; padding:1rem; }
    .mq-card h3{ font-size:1.1rem; margin:0 0 .25rem 0; }
    .mq-card p{ margin:0; color:var(--muted); }
    @media (min-width:768px){ .mq-cards{ grid-template-columns:repeat(2,1fr); } }
    @media (min-width:992px){ .mq-cards{ grid-template-columns:repeat(3,1fr); } }
  </style>
  
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom border-dark-subtle">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
        <img src="Logos/logoBmini.png" alt="Logo" width="60" height="48" class="rounded-2">
        Music
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain" aria-controls="navMain" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div id="navMain" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">
          <li class="nav-item"><a class="nav-link" href="index.html"><i class="bi bi-house me-1"></i>Home</a></li>
          <li class="nav-item"><a class="nav-link" href="listen.html"><i class="bi bi-music-note-beamed me-1"></i>Browse Songs</a></li>
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="playlist.html"><i class="bi bi-heart-fill me-1"></i>My Playlist</a></li>
          <li class="nav-item"><a class="nav-link" href="#contact"><i class="bi bi-envelope me-1"></i>Contact</a></li>
          <li class="nav-item ms-lg-2">
            <div class="btn-group" role="group" aria-label="Quick actions">
              <a class="btn btn-sm btn-outline-light" href="listen.html">Songs</a>
              <a class="btn btn-sm btn-primary" href="#carousel">Carousel</a>
              <a class="btn btn-sm btn-outline-light" href="#cards">Cards</a>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <div class="vinyl mt-3">
    <div class="label"></div>
    <div class="spindle"></div>
  </div>

  <header class="container py-4 text-center">
    <h1 class="display-title mb-2">My Playlist</h1>
    <p class="lead mb-0">Bootstrap Grid + Media Queries</p>
  </header>

  <main class="container pb-5">
    <div class="row g-3 align-items-end mb-3">
      <div class="col-12 col-lg-8">
        <label for="search" class="form-label mb-1">Search in my playlist</label>
        <input id="search" type="search" class="form-control form-control-lg" placeholder="Start typing a song title..." autocomplete="off">
      </div>
      <div class="col-12 col-lg-4 d-flex">
        <button id="clearAll" class="btn btn-danger ms-lg-auto w-100 w-lg-auto d-none">
          <i class="bi bi-trash3 me-2"></i>Clear All
        </button>
      </div>
    </div>

    <div id="emptyState" class="text-center py-5 d-none">
      <h3 class="fw-normal">My playlist is empty</h3>
      <p class="muted mb-3">Add some tracks to get started</p>
      <a class="btn btn-primary btn-lg" href="listen.html"><i class="bi bi-music-note-list me-2"></i>Browse Songs</a>
    </div>

    <div id="playlistList" class="vstack gap-2"></div>

    <div class="audio-wrap mt-4">
      <audio id="player" controls preload="none" aria-label="Audio player"></audio>
    </div>

    <!-- CSS-only cards -->
    <section class="mt-5" id="mq-cards">
      <h2 class="mb-3">Media Queries Card Group</h2>
      <div class="mq-cards">
        <article class="mq-card"><h3>Clean Code</h3><p>Consistent spacing, readable structure, and semantic HTML</p></article>
        <article class="mq-card"><h3>Performance</h3><p>Minimal reflows, efficient DOM updates, and safe localStorage</p></article>
        <article class="mq-card"><h3>Accessibility</h3><p>Meaningful roles, labels, focus management, and contrast</p></article>
      </div>
    </section>

    <!-- Grid demo -->
    <section class="mt-5" id="grid">
      <h2 class="mb-3"></h2>
      <div class="row g-3 mb-3">
        <div class="col-sm-12 col-lg-6"><div class="p-3 rounded-3" style="background:#7fd367;border:1px solid #1b1f27;"><h3 class="h5 mb-2">First Column</h3><p class="mb-0 muted">Firstly Bootstrap using</p></div></div>
        <div class="col-sm-12 col-lg-6"><div class="p-3 rounded-3" style="background:#7fd367;border:1px solid #1b1f27;"><h3 class="h5 mb-2">Second column</h3><p class="mb-0 muted">Secondly Bootstrap using</p></div></div>
      </div>
      <div class="row g-3">
        <div class="col-sm-12 col-md-6 col-lg-4"><div class="p-3 rounded-3" style="background:#7fd367;border:1px solid #1b1f27;"><h3 class="h6 mb-2">Thrid Column</h3><p class="mb-0 muted">Thirdly Bootstrap using</p></div></div>
        <div class="col-sm-12 col-md-6 col-lg-4"><div class="p-3 rounded-3" style="background:#7fd367;border:1px solid #1b1f27;"><h3 class="h6 mb-2">Four Column</h3><p class="mb-0 muted">Fourty Bootstrap using</p></div></div>
        <div class="col-sm-12 col-md-6 col-lg-4"><div class="p-3 rounded-3" style="background:#7fd367;border:1px solid #1b1f27;"><h3 class="h6 mb-2">Five Column</h3><p class="mb-0 muted">Fifty Bootstrap using</p></div></div>
      </div>
    </section>

    <!-- Carousel + thumbs -->
    <section class="mt-5" id="carousel">
      <h2 class="mb-3">Carousel</h2>
      <div id="coversCarousel" class="carousel slide" data-bs-ride="carousel" aria-label="Album covers carousel">
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#coversCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
          <button type="button" data-bs-target="#coversCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
          <button type="button" data-bs-target="#coversCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner rounded-4 border border-dark">
          <div class="carousel-item active"><img src="https://picsum.photos/1200/400?random=13" class="d-block w-100" alt="Cover 1"></div>
          <div class="carousel-item "><img src="https://picsum.photos/1200/400?random=12" class="d-block w-100" alt="Cover 2"></div>
          <div class="carousel-item "><img src="https://picsum.photos/1200/400?random=13" class="d-block w-100" alt="Cover 3"></div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#coversCarousel" data-bs-slide="prev" aria-label="Previous"><span class="carousel-control-prev-icon" aria-hidden="true"></span></button>
        <button class="carousel-control-next" type="button" data-bs-target="#coversCarousel" data-bs-slide="next" aria-label="Next"><span class="carousel-control-next-icon" aria-hidden="true"></span></button>
      </div>
      <div class="row g-3 mt-3">
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=21" alt="Thumb 1"></div>
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=22" alt="Thumb 2"></div>
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=23" alt="Thumb 3"></div>
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=24" alt="Thumb 4"></div>
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=25" alt="Thumb 5"></div>
        <div class="col-6 col-md-4 col-lg-2"><img class="img-fluid rounded-3 border border-dark" src="https://picsum.photos/400/300?random=26" alt="Thumb 6"></div>
      </div>
    </section>

    <!-- Cards -->
    <section class="mt-5" id="cards">
      <h2 class="mb-3">Bootstrap Cards</h2>
      <div class="card-group">
        <div class="card bg-dark text-white border border-secondary">
          <img src="https://picsum.photos/600/300?random=31" class="card-img-top" alt="Playlist A">
          <div class="card-body"><h5 class="card-title">Chill Vibes</h5><p class="card-text">Relaxing tracks to focus and unwind</p><a href="listen.html" class="btn btn-outline-light btn-sm">Open</a></div>
        </div>
        <div class="card bg-dark text-white border border-secondary">
          <img src="https://picsum.photos/600/300?random=32" class="card-img-top" alt="Playlist B">
          <div class="card-body"><h5 class="card-title">Classic Rock</h5><p class="card-text">Guitar-driven hits across decades</p><a href="listen.html" class="btn btn-outline-light btn-sm">Open</a></div>
        </div>
        <div class="card bg-dark text-white border border-secondary">
          <img src="https://picsum.photos/600/300?random=33" class="card-img-top" alt="Playlist C">
          <div class="card-body"><h5 class="card-title">Electro Boost</h5><p class="card-text">High-energy electronic anthems</p><a href="listen.html" class="btn btn-outline-light btn-sm">Open</a></div>
        </div>
      </div>
    </section>

    <!-- Contact form -->
    <section class="mt-5" id="contact" aria-labelledby="contactTitle">
      <h2 id="contactTitle" class="mb-3">Contact us</h2>
      <form class="row g-3">
        <div class="col-md-6">
          <label for="name" class="form-label">Your name</label>
          <input type="text" class="form-control" id="name" placeholder="Full name" required>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">Email</label>
          <div class="input-group">
            <span class="input-group-text" id="emailPrepend">@</span>
            <input type="email" class="form-control" id="email" aria-describedby="emailPrepend" placeholder="name@example.com" required>
          </div>
        </div>
        <div class="col-12">
          <label class="form-label d-block">Subscription</label>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="sub" id="sub1" checked>
            <label class="form-check-label" for="sub1">Weekly</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="sub" id="sub2">
            <label class="form-check-label" for="sub2">Monthly</label>
          </div>
        </div>
        <div class="col-12">
          <label for="message" class="form-label">Message</label>
          <textarea id="message" class="form-control" rows="4" placeholder="Your message..."></textarea>
        </div>
        <div class="col-12 d-flex gap-2">
          <button type="submit" class="btn btn-primary"><i class="bi bi-send me-1"></i>Send</button>
          <button type="reset" class="btn btn-outline-light">Reset</button>
        </div>
      </form>
    </section>
  </main>

  <footer class="border-top border-dark mt-5 py-4">
    <div class="container d-flex flex-column flex-md-row align-items-center justify-content-between gap-2">
      <span class="muted">© <span id="year"></span> Music</span>
      <span class="muted"><em>Team: Nuraly Abat Ramazan Talgatov Sultan Muratbek</em></span>
    </div>
  </footer>

  <!-- Modal (IDs JS) -->
  <div id="songInfoModal" class="song-info-modal" aria-hidden="true">
    <div class="song-info-content" role="dialog" aria-modal="true" aria-labelledby="modalSongTitle">
      <div class="song-info-header">
        <h3 id="modalSongTitle"></h3>
        <button class="close-btn" type="button" aria-label="Close modal" onclick="closeSongModal()">×</button>
      </div>
      <div class="song-info-body">
        <div class="info-item"><strong>Artist:</strong><span id="modalArtist"></span></div>
        <div class="info-item"><strong>Year:</strong><span id="modalYear"></span></div>
        <div class="info-item"><strong>Genre:</strong><span id="modalGenre"></span></div>
        <div class="song-description">
          <h4>About this track</h4>
          <p id="modalInfo"></p>
        </div>
      </div>
      <div class="song-info-actions">
        <button class="modal-btn play-modal-btn" id="modalPlayBtn" type="button"><i class="bi bi-play-fill me-1"></i>Play Now</button>
        <button class="modal-btn remove-modal-btn" id="modalRemoveBtn" type="button"><i class="bi bi-x-circle me-1"></i>Remove</button>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    let playlist = [];
    const els = {
      list: document.getElementById('playlistList'),
      search: document.getElementById('search'),
      player: document.getElementById('player'),
      clear: document.getElementById('clearAll'),
      empty: document.getElementById('emptyState'),
      modal: document.getElementById('songInfoModal'),
      t: (id)=>document.getElementById(id)
    };
    let currentSongIndex = null;

    function loadPlaylist(){
      try{ playlist = Array.isArray(JSON.parse(localStorage.getItem('playlist'))) ? JSON.parse(localStorage.getItem('playlist')) : []; }
      catch{ playlist = []; }
    }
    function render(filter=""){
      els.list.innerHTML = "";
      const hasAny = playlist.length>0;
      els.empty.classList.toggle('d-none', hasAny);
      els.clear.classList.toggle('d-none', !hasAny);
      if(!hasAny) return;

      const f = filter.trim().toLowerCase();
      const filtered = f ? playlist.filter(s => (s.title||"").toLowerCase().includes(f)) : playlist;

      if(filtered.length===0 && f){
        els.list.innerHTML = `<div class="text-center py-5 muted">No songs found matching "${filter.replace(/</g,"&lt;").replace(/>/g,"&gt;")}"</div>`;
        return;
      }
      const frag = document.createDocumentFragment();
      filtered.forEach(song=>{
        const idx = playlist.indexOf(song);
        const item = document.createElement('div');
        item.className = "song-item";
        item.innerHTML = `
          <div class="song-left">
            <button class="song-play" data-action="play" data-index="${idx}" title="Play"><i class="bi bi-play-fill"></i></button>
            <a class="song-title text-truncate" data-action="info" data-index="${idx}">${song.title ?? "Unknown title"}</a>
          </div>
          <button class="remove-btn" data-action="remove" data-index="${idx}" title="Remove from playlist">×</button>`;
        frag.appendChild(item);
      });
      els.list.appendChild(frag);
    }
    function playSong(index){
      const s = playlist[index]; if(!s || !s.file) return;
      els.player.src = s.file;
      const p = els.player.play(); if(p && typeof p.catch==='function') p.catch(()=>{});
    }
    function removeFromPlaylist(index){
      if(index<0 || index>=playlist.length) return;
      playlist.splice(index,1);
      localStorage.setItem('playlist', JSON.stringify(playlist));
      if(els.modal.classList.contains('show')) closeSongModal();
      render(els.search.value);
    }
    function clearAllPlaylist(){
      if(!confirm('Remove all songs from playlist?')) return;
      playlist = []; localStorage.removeItem('playlist'); render();
    }
    function openSongInfo(index){
      currentSongIndex = index;
      const s = playlist[index]; if(!s) return;
      els.t('modalSongTitle').textContent = s.title || "";
      els.t('modalArtist').textContent = s.artist || "";
      els.t('modalYear').textContent = s.year || "";
      els.t('modalGenre').textContent = s.genre || "";
      els.t('modalInfo').textContent = s.info || "";
      els.modal.classList.add('show'); document.body.style.overflow='hidden';
    }
    function closeSongModal(){
      els.modal.classList.remove('show'); els.modal.classList.add('hide'); document.body.style.overflow='auto';
      setTimeout(()=>{ els.modal.classList.remove('hide'); currentSongIndex=null; },300);
    }
    window.closeSongModal = closeSongModal;

    els.list.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-action]'); if(!btn) return;
      const action = btn.getAttribute('data-action'); const index = Number(btn.getAttribute('data-index'));
      if(action==='play') playSong(index);
      else if(action==='info') openSongInfo(index);
      else if(action==='remove') removeFromPlaylist(index);
    });
    let tId; els.search.addEventListener('input', ()=>{ clearTimeout(tId); tId=setTimeout(()=>render(els.search.value),120); });
    els.clear.addEventListener('click', clearAllPlaylist);
    document.getElementById('modalPlayBtn').addEventListener('click', ()=>{ if(currentSongIndex!==null){ playSong(currentSongIndex); closeSongModal(); } });
    document.getElementById('modalRemoveBtn').addEventListener('click', ()=>{ if(currentSongIndex!==null){ removeFromPlaylist(currentSongIndex); } });
    els.modal.addEventListener('click', (e)=>{ if(e.target===els.modal) closeSongModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && els.modal.classList.contains('show')) closeSongModal(); });

    loadPlaylist(); render();
  </script>

  <!-- Bootstrap Bundle -->
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="toggleTheme.js"></script>
  <script src="assignment7.js"></script>
</body>
</html>
